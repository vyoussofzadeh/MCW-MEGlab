% Script generated by Brainstorm (19-Aug-2019)

% Input files
sFiles = {...
    'hulan_eleanor/PN_hulan_eleanor_IC_data/data_PN_hulan_eleanor_IC_average_190805_1150_time.mat'};

% Start a new report
bst_report('Start', sFiles);

% Process: Extract time: [-300ms,2000ms]
sFiles = bst_process('CallProcess', 'process_extract_time', sFiles, [], ...
    'timewindow', [-0.3, 2], ...
    'overwrite',  0);

path_tools = '/usr/local/MATLAB_Tools';
set_ft
% Process: Compute sources BF-FT
sFiles = bst_process('CallProcess', 'vy_process_ft_sourceanalysis', sFiles, [], ...
    'Comment',     '', ...
    'method',      2, ...  % dSPM
    'mne',        struct(...
    'NoiseCov',      [], ...
    'InverseMethod', 'lcmv', ...
    'ChannelTypes',  {{}}, ...
    'SNR',           3, ...
    'diagnoise',     0, ...
    'SourceOrient',  {{'fixed'}}, ...
    'loose',         0.2, ...
    'depth',         1, ...
    'weightexp',     0.5, ...
    'weightlimit',   10, ...
    'regnoise',      1, ...
    'magreg',        0.1, ...
    'gradreg',       0.1, ...
    'eegreg',        0.1, ...
    'ecogreg',       0.1, ...
    'seegreg',       0.1, ...
    'fMRI',          [], ...
    'fMRIthresh',    [], ...
    'fMRIoff',       0.1, ...
    'pca',           1), ...
    'sensortypes', 'MEG, MEG MAG, MEG GRAD', ...
    'output',      1);  % Kernel only: shared

% Process: Compute sources [2018]
sFiles = bst_process('CallProcess', 'process_inverse_2018', sFiles, [], ...
    'output',  1, ...  % Kernel only: shared
    'inverse', struct(...
    'Comment',        'PNAI: MEG ALL', ...
    'InverseMethod',  'lcmv', ...
    'InverseMeasure', 'nai', ...
    'SourceOrient',   {{'fixed'}}, ...
    'Loose',          0.2, ...
    'UseDepth',       1, ...
    'WeightExp',      0.5, ...
    'WeightLimit',    10, ...
    'NoiseMethod',    'median', ...
    'NoiseReg',       0.1, ...
    'SnrMethod',      'rms', ...
    'SnrRms',         1e-06, ...
    'SnrFixed',       3, ...
    'ComputeKernel',  1, ...
    'DataTypes',      {{'MEG GRAD', 'MEG MAG'}}));

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);

