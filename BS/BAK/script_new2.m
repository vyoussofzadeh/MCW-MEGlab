% Script generated by Brainstorm (19-Aug-2019)

% Input files
sFiles = {...
    'hulan_eleanor/PN_hulan_eleanor_IC_data/data_PN_hulan_eleanor_IC_average_190805_1150_time.mat'};

% Start a new report
bst_report('Start', sFiles);

path_tools = '/usr/local/MATLAB_Tools';
set_ft
% Process: Compute sources BF-FT
sFiles = bst_process('CallProcess', 'vy_process_ft_sourceanalysis', sFiles, [], ...
    'Comment',     '', ...
    'method',      2, ...  % dSPM
    'mne',        struct(...
         'NoiseCov',      [], ...
         'InverseMethod', 'lcmv', ...
         'ChannelTypes',  {{}}, ...
         'SNR',           3, ...
         'diagnoise',     0, ...
         'SourceOrient',  {{'fixed'}}, ...
         'loose',         0.2, ...
         'depth',         1, ...
         'weightexp',     0.5, ...
         'weightlimit',   10, ...
         'regnoise',      1, ...
         'magreg',        0.1, ...
         'gradreg',       0.1, ...
         'eegreg',        0.1, ...
         'ecogreg',       0.1, ...
         'seegreg',       0.1, ...
         'fMRI',          [], ...
         'fMRIthresh',    [], ...
         'fMRIoff',       0.1, ...
         'pca',           1), ...
    'sensortypes', 'MEG, MEG MAG, MEG GRAD', ...
    'output',      1);  % Kernel only: shared

% Process: Compute sources [2009]
sFiles = bst_process('CallProcess', 'process_inverse', sFiles, [], ...
    'Comment',     '', ...
    'method',      2, ...  % dSPM
    'wmne',        struct(...
         'NoiseCov',      [], ...
         'InverseMethod', 'wmne', ...
         'ChannelTypes',  {{}}, ...
         'SNR',           3, ...
         'diagnoise',     0, ...
         'SourceOrient',  {{'fixed'}}, ...
         'loose',         0.2, ...
         'depth',         1, ...
         'weightexp',     0.5, ...
         'weightlimit',   10, ...
         'regnoise',      1, ...
         'magreg',        0.1, ...
         'gradreg',       0.1, ...
         'eegreg',        0.1, ...
         'ecogreg',       0.1, ...
         'seegreg',       0.1, ...
         'fMRI',          [], ...
         'fMRIthresh',    [], ...
         'fMRIoff',       0.1, ...
         'pca',           1), ...
    'sensortypes', 'MEG, MEG MAG, MEG GRAD', ...
    'output',      1);  % Kernel only: shared

% Process: Average time: [400ms,800ms], abs
sFiles = bst_process('CallProcess', 'process_average_time', sFiles, [], ...
    'timewindow', [0.4, 0.8], ...
    'isstd',      0, ...
    'overwrite',  0, ...
    'source_abs', 1);

% Save and display report
ReportFile = bst_report('Save', sFiles);
bst_report('Open', ReportFile);
% bst_report('Export', ReportFile, ExportDir);

